<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Christopher Torres">
<meta name="dcterms.date" content="2025-04-15">

<title>Homework 8 - World Bank Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="report_files/libs/clipboard/clipboard.min.js"></script>
<script src="report_files/libs/quarto-html/quarto.js"></script>
<script src="report_files/libs/quarto-html/popper.min.js"></script>
<script src="report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="report_files/libs/quarto-html/anchor.min.js"></script>
<link href="report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="report_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="report_files/libs/bootstrap/bootstrap-957abf0e8301ce287560cc8674794d32.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#problem-background" id="toc-problem-background" class="nav-link active" data-scroll-target="#problem-background">Problem Background</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a>
  <ul class="collapse">
  <li><a href="#task-1" id="toc-task-1" class="nav-link" data-scroll-target="#task-1">Task 1</a></li>
  <li><a href="#task-2" id="toc-task-2" class="nav-link" data-scroll-target="#task-2">Task 2</a></li>
  <li><a href="#task-3" id="toc-task-3" class="nav-link" data-scroll-target="#task-3">Task 3</a></li>
  <li><a href="#task-4" id="toc-task-4" class="nav-link" data-scroll-target="#task-4">Task 4</a></li>
  <li><a href="#task-5" id="toc-task-5" class="nav-link" data-scroll-target="#task-5">Task 5</a></li>
  <li><a href="#task-6" id="toc-task-6" class="nav-link" data-scroll-target="#task-6">Task 6</a></li>
  <li><a href="#task-7" id="toc-task-7" class="nav-link" data-scroll-target="#task-7">Task 7</a></li>
  <li><a href="#task-8" id="toc-task-8" class="nav-link" data-scroll-target="#task-8">Task 8</a></li>
  <li><a href="#task-9" id="toc-task-9" class="nav-link" data-scroll-target="#task-9">Task 9</a></li>
  <li><a href="#task-10" id="toc-task-10" class="nav-link" data-scroll-target="#task-10">Task 10</a></li>
  <li><a href="#task-11" id="toc-task-11" class="nav-link" data-scroll-target="#task-11">Task 11</a></li>
  <li><a href="#task-12" id="toc-task-12" class="nav-link" data-scroll-target="#task-12">Task 12</a></li>
  <li><a href="#task-13" id="toc-task-13" class="nav-link" data-scroll-target="#task-13">Task 13</a></li>
  <li><a href="#task-14" id="toc-task-14" class="nav-link" data-scroll-target="#task-14">Task 14</a></li>
  <li><a href="#task-15" id="toc-task-15" class="nav-link" data-scroll-target="#task-15">Task 15</a></li>
  <li><a href="#task-16" id="toc-task-16" class="nav-link" data-scroll-target="#task-16">Task 16</a></li>
  <li><a href="#task-17" id="toc-task-17" class="nav-link" data-scroll-target="#task-17">Task 17</a></li>
  <li><a href="#task-18" id="toc-task-18" class="nav-link" data-scroll-target="#task-18">Task 18</a></li>
  <li><a href="#task-19" id="toc-task-19" class="nav-link" data-scroll-target="#task-19">Task 19</a></li>
  <li><a href="#task-20" id="toc-task-20" class="nav-link" data-scroll-target="#task-20">Task 20</a></li>
  <li><a href="#task-21" id="toc-task-21" class="nav-link" data-scroll-target="#task-21">Task 21</a></li>
  </ul></li>
  <li><a href="#reflection" id="toc-reflection" class="nav-link" data-scroll-target="#reflection">Reflection</a></li>
  <li><a href="#readme" id="toc-readme" class="nav-link" data-scroll-target="#readme">README</a></li>
  <li><a href="#cmsc408-sp2025-hw8" id="toc-cmsc408-sp2025-hw8" class="nav-link" data-scroll-target="#cmsc408-sp2025-hw8">cmsc408-sp2025-hw8</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Homework 8 - World Bank Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Christopher Torres <a href="mailto:torresc6@vcu.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 15, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>We are back again! This time we are working through Hw8, the SQL Funhouse! We are going to work through 21 queries involving our remote country database, and manipulating a local copy of the database, which we will create in Task # 4. I am extremely excited to share the results with you! Here are each of the queries, their code, and the results!</p>
<p>Ready to learn more SQL? Let’s go!</p>
<p>GITHUB URL: <a href="https://github.com/cmsc-vcu/cmsc408-sp2025-hw8-serrotrehpotsirhc.git" class="uri">https://github.com/cmsc-vcu/cmsc408-sp2025-hw8-serrotrehpotsirhc.git</a></p>
<section id="problem-background" class="level1">
<h1>Problem Background</h1>
<div id="a38f0282" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> helpers <span class="im">import</span> create_database_engine, run_sql_and_return_df, run_sql_and_return_html, create_db_wrapper, execute_ddl_from_file, execute_ddl</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load these variables from .env file.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>config_map <span class="op">=</span> {</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'user'</span>: <span class="st">"CMSC408_HW8_USER"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'password'</span>: <span class="st">"CMSC408_HW8_PASSWORD"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">'host'</span>: <span class="st">"CMSC408_HW8_HOST"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">'database'</span>: <span class="st">"CMSC408_HW8_DB_NAME"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>cnx,config <span class="op">=</span> create_db_wrapper( config_map )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="dbda1e75" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Do a quick test of the connection and trap the errors better!</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="st">select</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="st">  table_schema, table_name, table_rows</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="st">from</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="st">  information_schema.tables</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="st">where</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="st">  table_schema in ('world_bank_data')</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="132">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
TABLE_SCHEMA
</th>

<th>
TABLE_NAME
</th>

<th>
TABLE_ROWS
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
world_bank_data
</td>

<td>
wdi_country
</td>

<td>
265
</td>

</tr>

<tr>

<td>
world_bank_data
</td>

<td>
wdi_data
</td>

<td>
369046
</td>

</tr>

<tr>

<td>
world_bank_data
</td>

<td>
wdi_series
</td>

<td>
1395
</td>

</tr>

<tr>
<td colspan="3" style="text-align: left;">
Total Rows: 3, Total Columns: 3
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="exercises" class="level1">
<h1>Exercises</h1>
<p>In the following exercises, write the SQL as requested to discover the answer.</p>
<section id="task-1" class="level2">
<h2 class="anchored" data-anchor-id="task-1">Task 1</h2>
<p>How many records are in the country table?</p>
<div id="85031ffb" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many records are in the world_bank_data.wdi_country table?</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (skills: select, aggregate)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="st">select</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">  count(*) as "Row Count"</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="st">from</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="st">  world_bank_data.wdi_country</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="133">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Row Count
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
265
</td>

</tr>

<tr>
<td colspan="1" style="text-align: left;">
Total Rows: 1, Total Columns: 1
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-2" class="level2">
<h2 class="anchored" data-anchor-id="task-2">Task 2</h2>
<p>Explore the first 5 records in the country table.</p>
<div id="348e8c3b" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">## write out the first 10 records and look at the columns</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Do you see any blanks or missing data?</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, limit)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="st">select</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="st">  *</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="st">from </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="st">  world_bank_data.wdi_country</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="st">limit 5</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="134">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Country Code
</th>

<th>
Short Name
</th>

<th>
Table Name
</th>

<th>
Long Name
</th>

<th>
2-alpha code
</th>

<th>
Currency Unit
</th>

<th>
Special Notes
</th>

<th>
Region
</th>

<th>
Income Group
</th>

<th>
WB-2 code
</th>

<th>
National accounts base year
</th>

<th>
National accounts reference year
</th>

<th>
SNA price valuation
</th>

<th>
Lending category
</th>

<th>
Other groups
</th>

<th>
System of National Accounts
</th>

<th>
Alternative conversion factor
</th>

<th>
PPP survey year
</th>

<th>
Balance of Payments Manual in use
</th>

<th>
External debt Reporting status
</th>

<th>
System of trade
</th>

<th>
Government Accounting concept
</th>

<th>
IMF data dissemination standard
</th>

<th>
Latest population census
</th>

<th>
Latest household survey
</th>

<th>
Source of most recent Income and expenditure data
</th>

<th>
Vital registration complete
</th>

<th>
Latest agricultural census
</th>

<th>
Latest industrial data
</th>

<th>
Latest trade data
</th>

<th>
Latest water withdrawal data
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
ABW
</td>

<td>
Aruba
</td>

<td>
Aruba
</td>

<td>
Aruba
</td>

<td>
AW
</td>

<td>
Aruban florin
</td>

<td>
NULL
</td>

<td>
Latin America &amp; Caribbean
</td>

<td>
High income
</td>

<td>
AW
</td>

<td>
2013
</td>

<td>
NULL
</td>

<td>
Value added at basic prices (VAB)
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
Country uses the 1993 System of National Accounts methodology
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
BPM6
</td>

<td>
NULL
</td>

<td>
General trade system
</td>

<td>
NULL
</td>

<td>
Enhanced General Data Dissemination System (e-GDDS)
</td>

<td>
2020 (expected)
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
Yes
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
2018.0
</td>

<td>
NULL
</td>

</tr>

<tr>

<td>
AFE
</td>

<td>
Africa Eastern and Southern
</td>

<td>
Africa Eastern and Southern
</td>

<td>
Africa Eastern and Southern
</td>

<td>
ZH
</td>

<td>
NULL
</td>

<td>
26 countries, stretching from the Red Sea in the North to the Cape of Good Hope in the South (https://www.worldbank.org/en/region/afr/eastern-and-southern-africa)
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
ZH
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

</tr>

<tr>

<td>
AFG
</td>

<td>
Afghanistan
</td>

<td>
Afghanistan
</td>

<td>
Islamic State of Afghanistan
</td>

<td>
AF
</td>

<td>
Afghan afghani
</td>

<td>
The reporting period for national accounts data is designated as either calendar year basis (CY) or fiscal year basis (FY). For this country, it is fiscal year-based (fiscal year-end: March 20). Also, an estimate (PA.NUS.ATLS) of the exchange rate covers the same period and thus differs from the official exchange rate (CY).\n\nIn addition, the World Bank systematically assesses the appropriateness of official exchange rates as conversion factors. In this country, multiple or dual exchange rate activity exists and must be accounted for appropriately in underlying statistics. An alternative estimate (“alternative conversion factor” - PA.NUS.ATLS) is thus calculated as a weighted average of the different exchange rates in use in the country. Doing so better reflects economic reality and leads to more accurate cross-country comparisons and country classifications by income level. For this country, this applies to the period 1960-2006. Alternative conversion factors are used in the Atlas methodology and elsewhere in World Development Indicators as single-year conversion factors.
</td>

<td>
South Asia
</td>

<td>
Low income
</td>

<td>
AF
</td>

<td>
2016
</td>

<td>
NULL
</td>

<td>
Value added at basic prices (VAB)
</td>

<td>
IDA
</td>

<td>
HIPC
</td>

<td>
Country uses the 2008 System of National Accounts methodology
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
BPM6
</td>

<td>
Estimate
</td>

<td>
General trade system
</td>

<td>
Consolidated central government
</td>

<td>
Enhanced General Data Dissemination System (e-GDDS)
</td>

<td>
1979
</td>

<td>
Demographic and Health Survey, 2015
</td>

<td>
Integrated household survey (IHS), 2016/17
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
2018.0
</td>

<td>
NULL
</td>

</tr>

<tr>

<td>
AFW
</td>

<td>
Africa Western and Central
</td>

<td>
Africa Western and Central
</td>

<td>
Africa Western and Central
</td>

<td>
ZI
</td>

<td>
NULL
</td>

<td>
22 countries, stretching from the westernmost point of Africa, across the equator, and partly along the Atlantic Ocean till the Republic of Congo in the South (https://www.worldbank.org/en/region/afr/western-and-central-africa)
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
ZI
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

</tr>

<tr>

<td>
AGO
</td>

<td>
Angola
</td>

<td>
Angola
</td>

<td>
People's Republic of Angola
</td>

<td>
AO
</td>

<td>
Angolan kwanza
</td>

<td>
The World Bank systematically assesses the appropriateness of official exchange rates as conversion factors. In this country, multiple or dual exchange rate activity exists and must be accounted for appropriately in underlying statistics. An alternative estimate (“alternative conversion factor” - PA.NUS.ATLS) is thus calculated as a weighted average of the different exchange rates in use in the country. Doing so better reflects economic reality and leads to more accurate cross-country comparisons and country classifications by income level. For this country, this applies to the period 1994-2023. Alternative conversion factors are used in the Atlas methodology and elsewhere in World Development Indicators as single-year conversion factors.
</td>

<td>
Sub-Saharan Africa
</td>

<td>
Lower middle income
</td>

<td>
AO
</td>

<td>
2002
</td>

<td>
NULL
</td>

<td>
Value added at basic prices (VAB)
</td>

<td>
IBRD
</td>

<td>
NULL
</td>

<td>
Country uses the 1993 System of National Accounts methodology
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
BPM6
</td>

<td>
Actual
</td>

<td>
General trade system
</td>

<td>
Budgetary central government
</td>

<td>
Enhanced General Data Dissemination System (e-GDDS)
</td>

<td>
2014
</td>

<td>
Demographic and Health Survey, 2015/16
</td>

<td>
Integrated household survey (IHS), 2008/09
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
2018.0
</td>

<td>
NULL
</td>

</tr>

<tr>
<td colspan="31" style="text-align: left;">
Total Rows: 5, Total Columns: 31
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-3" class="level2">
<h2 class="anchored" data-anchor-id="task-3">Task 3</h2>
<p>List all non-countries.</p>
<div id="f5c87de4" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">## task 3</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Which records are NOT for countries, that is they're for regions or groups of countries.</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">## How can you tell?</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Once you figure it out, write a query to list all the non-countries</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, where)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="st">  `Short Name`</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="st">  world_bank_data.wdi_country</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="st">  `Table Name` != 'Country' OR `Table Name` IS NULL</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="st">  `Short Name`;</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="135">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Short Name
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
Afghanistan
</td>

</tr>

<tr>

<td>
Africa Eastern and Southern
</td>

</tr>

<tr>

<td>
Africa Western and Central
</td>

</tr>

<tr>

<td>
Albania
</td>

</tr>

<tr>

<td>
Algeria
</td>

</tr>

<tr>

<td>
American Samoa
</td>

</tr>

<tr>

<td>
Andorra
</td>

</tr>

<tr>

<td>
Angola
</td>

</tr>

<tr>

<td>
Antigua and Barbuda
</td>

</tr>

<tr>

<td>
Arab World
</td>

</tr>

<tr>

<td>
Argentina
</td>

</tr>

<tr>

<td>
Armenia
</td>

</tr>

<tr>

<td>
Aruba
</td>

</tr>

<tr>

<td>
Australia
</td>

</tr>

<tr>

<td>
Austria
</td>

</tr>

<tr>

<td>
Azerbaijan
</td>

</tr>

<tr>

<td>
Bahrain
</td>

</tr>

<tr>

<td>
Bangladesh
</td>

</tr>

<tr>

<td>
Barbados
</td>

</tr>

<tr>

<td>
Belarus
</td>

</tr>

<tr>

<td>
Belgium
</td>

</tr>

<tr>

<td>
Belize
</td>

</tr>

<tr>

<td>
Benin
</td>

</tr>

<tr>

<td>
Bermuda
</td>

</tr>

<tr>

<td>
Bhutan
</td>

</tr>

<tr>

<td>
Bolivia
</td>

</tr>

<tr>

<td>
Bosnia and Herzegovina
</td>

</tr>

<tr>

<td>
Botswana
</td>

</tr>

<tr>

<td>
Brazil
</td>

</tr>

<tr>

<td>
British Virgin Islands
</td>

</tr>

<tr>

<td>
Brunei
</td>

</tr>

<tr>

<td>
Bulgaria
</td>

</tr>

<tr>

<td>
Burkina Faso
</td>

</tr>

<tr>

<td>
Burundi
</td>

</tr>

<tr>

<td>
Cabo Verde
</td>

</tr>

<tr>

<td>
Cambodia
</td>

</tr>

<tr>

<td>
Cameroon
</td>

</tr>

<tr>

<td>
Canada
</td>

</tr>

<tr>

<td>
Caribbean small states
</td>

</tr>

<tr>

<td>
Cayman Islands
</td>

</tr>

<tr>

<td>
Central African Republic
</td>

</tr>

<tr>

<td>
Central Europe and the Baltics
</td>

</tr>

<tr>

<td>
Chad
</td>

</tr>

<tr>

<td>
Channel Islands
</td>

</tr>

<tr>

<td>
Chile
</td>

</tr>

<tr>

<td>
China
</td>

</tr>

<tr>

<td>
Colombia
</td>

</tr>

<tr>

<td>
Comoros
</td>

</tr>

<tr>

<td>
Congo
</td>

</tr>

<tr>

<td>
Costa Rica
</td>

</tr>

<tr>

<td>
Côte d'Ivoire
</td>

</tr>

<tr>

<td>
Croatia
</td>

</tr>

<tr>

<td>
Cuba
</td>

</tr>

<tr>

<td>
Curaçao
</td>

</tr>

<tr>

<td>
Cyprus
</td>

</tr>

<tr>

<td>
Czechia
</td>

</tr>

<tr>

<td>
Dem. People's Rep.&nbsp;Korea
</td>

</tr>

<tr>

<td>
Dem. Rep.&nbsp;Congo
</td>

</tr>

<tr>

<td>
Denmark
</td>

</tr>

<tr>

<td>
Djibouti
</td>

</tr>

<tr>

<td>
Dominica
</td>

</tr>

<tr>

<td>
Dominican Republic
</td>

</tr>

<tr>

<td>
Early-demographic dividend
</td>

</tr>

<tr>

<td>
East Asia &amp; Pacific
</td>

</tr>

<tr>

<td>
East Asia &amp; Pacific (excluding high income)
</td>

</tr>

<tr>

<td>
East Asia &amp; Pacific (IDA &amp; IBRD)
</td>

</tr>

<tr>

<td>
Ecuador
</td>

</tr>

<tr>

<td>
Egypt
</td>

</tr>

<tr>

<td>
El Salvador
</td>

</tr>

<tr>

<td>
Equatorial Guinea
</td>

</tr>

<tr>

<td>
Eritrea
</td>

</tr>

<tr>

<td>
Estonia
</td>

</tr>

<tr>

<td>
Eswatini
</td>

</tr>

<tr>

<td>
Ethiopia
</td>

</tr>

<tr>

<td>
Euro area
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia (excluding high income)
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia (IDA &amp; IBRD)
</td>

</tr>

<tr>

<td>
European Union
</td>

</tr>

<tr>

<td>
Faroe Islands
</td>

</tr>

<tr>

<td>
Fiji
</td>

</tr>

<tr>

<td>
Finland
</td>

</tr>

<tr>

<td>
Fragile and conflict affected situations
</td>

</tr>

<tr>

<td>
France
</td>

</tr>

<tr>

<td>
French Polynesia
</td>

</tr>

<tr>

<td>
Gabon
</td>

</tr>

<tr>

<td>
Georgia
</td>

</tr>

<tr>

<td>
Germany
</td>

</tr>

<tr>

<td>
Ghana
</td>

</tr>

<tr>

<td>
Gibraltar
</td>

</tr>

<tr>

<td>
Greece
</td>

</tr>

<tr>

<td>
Greenland
</td>

</tr>

<tr>

<td>
Grenada
</td>

</tr>

<tr>

<td>
Guam
</td>

</tr>

<tr>

<td>
Guatemala
</td>

</tr>

<tr>

<td>
Guinea
</td>

</tr>

<tr>

<td>
Guinea-Bissau
</td>

</tr>

<tr>

<td>
Guyana
</td>

</tr>

<tr>

<td>
Haiti
</td>

</tr>

<tr>

<td>
Heavily indebted poor countries (HIPC)
</td>

</tr>

<tr>

<td>
High income
</td>

</tr>

<tr>

<td>
Honduras
</td>

</tr>

<tr>

<td>
Hong Kong SAR, China
</td>

</tr>

<tr>

<td>
Hungary
</td>

</tr>

<tr>

<td>
IBRD only
</td>

</tr>

<tr>

<td>
Iceland
</td>

</tr>

<tr>

<td>
IDA &amp; IBRD total
</td>

</tr>

<tr>

<td>
IDA blend
</td>

</tr>

<tr>

<td>
IDA only
</td>

</tr>

<tr>

<td>
IDA total
</td>

</tr>

<tr>

<td>
India
</td>

</tr>

<tr>

<td>
Indonesia
</td>

</tr>

<tr>

<td>
Iran
</td>

</tr>

<tr>

<td>
Iraq
</td>

</tr>

<tr>

<td>
Ireland
</td>

</tr>

<tr>

<td>
Isle of Man
</td>

</tr>

<tr>

<td>
Israel
</td>

</tr>

<tr>

<td>
Italy
</td>

</tr>

<tr>

<td>
Jamaica
</td>

</tr>

<tr>

<td>
Japan
</td>

</tr>

<tr>

<td>
Jordan
</td>

</tr>

<tr>

<td>
Kazakhstan
</td>

</tr>

<tr>

<td>
Kenya
</td>

</tr>

<tr>

<td>
Kiribati
</td>

</tr>

<tr>

<td>
Korea
</td>

</tr>

<tr>

<td>
Kosovo
</td>

</tr>

<tr>

<td>
Kuwait
</td>

</tr>

<tr>

<td>
Kyrgyz Republic
</td>

</tr>

<tr>

<td>
Lao PDR
</td>

</tr>

<tr>

<td>
Late-demographic dividend
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean (excluding high income)
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean (IDA &amp; IBRD)
</td>

</tr>

<tr>

<td>
Latvia
</td>

</tr>

<tr>

<td>
Least developed countries: UN classification
</td>

</tr>

<tr>

<td>
Lebanon
</td>

</tr>

<tr>

<td>
Lesotho
</td>

</tr>

<tr>

<td>
Liberia
</td>

</tr>

<tr>

<td>
Libya
</td>

</tr>

<tr>

<td>
Liechtenstein
</td>

</tr>

<tr>

<td>
Lithuania
</td>

</tr>

<tr>

<td>
Low &amp; middle income
</td>

</tr>

<tr>

<td>
Low income
</td>

</tr>

<tr>

<td>
Lower middle income
</td>

</tr>

<tr>

<td>
Luxembourg
</td>

</tr>

<tr>

<td>
Macao SAR, China
</td>

</tr>

<tr>

<td>
Madagascar
</td>

</tr>

<tr>

<td>
Malawi
</td>

</tr>

<tr>

<td>
Malaysia
</td>

</tr>

<tr>

<td>
Maldives
</td>

</tr>

<tr>

<td>
Mali
</td>

</tr>

<tr>

<td>
Malta
</td>

</tr>

<tr>

<td>
Marshall Islands
</td>

</tr>

<tr>

<td>
Mauritania
</td>

</tr>

<tr>

<td>
Mauritius
</td>

</tr>

<tr>

<td>
Mexico
</td>

</tr>

<tr>

<td>
Micronesia
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa (excluding high income)
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa (IDA &amp; IBRD)
</td>

</tr>

<tr>

<td>
Middle income
</td>

</tr>

<tr>

<td>
Moldova
</td>

</tr>

<tr>

<td>
Monaco
</td>

</tr>

<tr>

<td>
Mongolia
</td>

</tr>

<tr>

<td>
Montenegro
</td>

</tr>

<tr>

<td>
Morocco
</td>

</tr>

<tr>

<td>
Mozambique
</td>

</tr>

<tr>

<td>
Myanmar
</td>

</tr>

<tr>

<td>
Namibia
</td>

</tr>

<tr>

<td>
Nauru
</td>

</tr>

<tr>

<td>
Nepal
</td>

</tr>

<tr>

<td>
Netherlands
</td>

</tr>

<tr>

<td>
New Caledonia
</td>

</tr>

<tr>

<td>
New Zealand
</td>

</tr>

<tr>

<td>
Nicaragua
</td>

</tr>

<tr>

<td>
Niger
</td>

</tr>

<tr>

<td>
Nigeria
</td>

</tr>

<tr>

<td>
North America
</td>

</tr>

<tr>

<td>
North Macedonia
</td>

</tr>

<tr>

<td>
Northern Mariana Islands
</td>

</tr>

<tr>

<td>
Norway
</td>

</tr>

<tr>

<td>
OECD members
</td>

</tr>

<tr>

<td>
Oman
</td>

</tr>

<tr>

<td>
Other small states
</td>

</tr>

<tr>

<td>
Pacific island small states
</td>

</tr>

<tr>

<td>
Pakistan
</td>

</tr>

<tr>

<td>
Palau
</td>

</tr>

<tr>

<td>
Panama
</td>

</tr>

<tr>

<td>
Papua New Guinea
</td>

</tr>

<tr>

<td>
Paraguay
</td>

</tr>

<tr>

<td>
Peru
</td>

</tr>

<tr>

<td>
Philippines
</td>

</tr>

<tr>

<td>
Poland
</td>

</tr>

<tr>

<td>
Portugal
</td>

</tr>

<tr>

<td>
Post-demographic dividend
</td>

</tr>

<tr>

<td>
Pre-demographic dividend
</td>

</tr>

<tr>

<td>
Puerto Rico
</td>

</tr>

<tr>

<td>
Qatar
</td>

</tr>

<tr>

<td>
Romania
</td>

</tr>

<tr>

<td>
Russia
</td>

</tr>

<tr>

<td>
Rwanda
</td>

</tr>

<tr>

<td>
Samoa
</td>

</tr>

<tr>

<td>
San Marino
</td>

</tr>

<tr>

<td>
São Tomé and Principe
</td>

</tr>

<tr>

<td>
Saudi Arabia
</td>

</tr>

<tr>

<td>
Senegal
</td>

</tr>

<tr>

<td>
Serbia
</td>

</tr>

<tr>

<td>
Seychelles
</td>

</tr>

<tr>

<td>
Sierra Leone
</td>

</tr>

<tr>

<td>
Singapore
</td>

</tr>

<tr>

<td>
Sint Maarten (Dutch part)
</td>

</tr>

<tr>

<td>
Slovak Republic
</td>

</tr>

<tr>

<td>
Slovenia
</td>

</tr>

<tr>

<td>
Small states
</td>

</tr>

<tr>

<td>
Solomon Islands
</td>

</tr>

<tr>

<td>
Somalia
</td>

</tr>

<tr>

<td>
South Africa
</td>

</tr>

<tr>

<td>
South Asia
</td>

</tr>

<tr>

<td>
South Asia (IDA &amp; IBRD)
</td>

</tr>

<tr>

<td>
South Sudan
</td>

</tr>

<tr>

<td>
Spain
</td>

</tr>

<tr>

<td>
Sri Lanka
</td>

</tr>

<tr>

<td>
St.&nbsp;Kitts and Nevis
</td>

</tr>

<tr>

<td>
St.&nbsp;Lucia
</td>

</tr>

<tr>

<td>
St.&nbsp;Martin (French part)
</td>

</tr>

<tr>

<td>
St.&nbsp;Vincent and the Grenadines
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa (excluding high income)
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa (IDA &amp; IBRD)
</td>

</tr>

<tr>

<td>
Sudan
</td>

</tr>

<tr>

<td>
Suriname
</td>

</tr>

<tr>

<td>
Sweden
</td>

</tr>

<tr>

<td>
Switzerland
</td>

</tr>

<tr>

<td>
Syrian Arab Republic
</td>

</tr>

<tr>

<td>
Tajikistan
</td>

</tr>

<tr>

<td>
Tanzania
</td>

</tr>

<tr>

<td>
Thailand
</td>

</tr>

<tr>

<td>
The Bahamas
</td>

</tr>

<tr>

<td>
The Gambia
</td>

</tr>

<tr>

<td>
Timor-Leste
</td>

</tr>

<tr>

<td>
Togo
</td>

</tr>

<tr>

<td>
Tonga
</td>

</tr>

<tr>

<td>
Trinidad and Tobago
</td>

</tr>

<tr>

<td>
Tunisia
</td>

</tr>

<tr>

<td>
Türkiye
</td>

</tr>

<tr>

<td>
Turkmenistan
</td>

</tr>

<tr>

<td>
Turks and Caicos Islands
</td>

</tr>

<tr>

<td>
Tuvalu
</td>

</tr>

<tr>

<td>
Uganda
</td>

</tr>

<tr>

<td>
Ukraine
</td>

</tr>

<tr>

<td>
United Arab Emirates
</td>

</tr>

<tr>

<td>
United Kingdom
</td>

</tr>

<tr>

<td>
United States
</td>

</tr>

<tr>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
Uruguay
</td>

</tr>

<tr>

<td>
Uzbekistan
</td>

</tr>

<tr>

<td>
Vanuatu
</td>

</tr>

<tr>

<td>
Venezuela
</td>

</tr>

<tr>

<td>
Viet Nam
</td>

</tr>

<tr>

<td>
Virgin Islands
</td>

</tr>

<tr>

<td>
West Bank and Gaza
</td>

</tr>

<tr>

<td>
World
</td>

</tr>

<tr>

<td>
Yemen
</td>

</tr>

<tr>

<td>
Zambia
</td>

</tr>

<tr>

<td>
Zimbabwe
</td>

</tr>

<tr>
<td colspan="1" style="text-align: left;">
Total Rows: 265, Total Columns: 1
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-4" class="level2">
<h2 class="anchored" data-anchor-id="task-4">Task 4</h2>
<p>Create your own copy of WDI_Country containing just countries.</p>
<div id="4b5c2666" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">## task 4</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">## The WDI table clearly contains information for countries and non-countries</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">## using CREATE TABLE ... SELECT from WHERE syntax.</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Finally, below write a query to return the number</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">## of records in the new table.</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, aggregate)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># drop table</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>execute_ddl(cnx,<span class="st">"""</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="st">drop table if exists wdi_country;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="25239a0f" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create table</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>execute_ddl(cnx,<span class="st">"""</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="st">CREATE TABLE wdi_country AS</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT *</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="st">FROM world_bank_data.wdi_country</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE Region IS NOT NULL;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3711f19d" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show number of records</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">  COUNT(*) AS "Row Count"</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="st">  wdi_country</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="138">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Row Count
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
217
</td>

</tr>

<tr>
<td colspan="1" style="text-align: left;">
Total Rows: 1, Total Columns: 1
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-5" class="level2">
<h2 class="anchored" data-anchor-id="task-5">Task 5</h2>
<p>According to the World Bank, in 2020 there were how many countries in the world?</p>
<div id="266efd8c" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, aggregate)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT COUNT(*) AS "Country Count"</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="st">FROM world_bank_data.wdi_country</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE Region IS NOT NULL;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="139">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Country Count
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
217
</td>

</tr>

<tr>
<td colspan="1" style="text-align: left;">
Total Rows: 1, Total Columns: 1
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-6" class="level2">
<h2 class="anchored" data-anchor-id="task-6">Task 6</h2>
<p>What are all unique values of region in the wdi_country table?</p>
<div id="366be327" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Let's investigate the country_region field.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">## What is the domain of the country_region field? That is,</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">## what are the unique values found there?</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">## (there are several possible ways to code this in SQL)</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, aggregate, order by)</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT DISTINCT Region</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="st">FROM world_bank_data.wdi_country</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE Region IS NOT NULL</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY Region;</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="140">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Region
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
East Asia &amp; Pacific
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

</tr>

<tr>

<td>
North America
</td>

</tr>

<tr>

<td>
South Asia
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

</tr>

<tr>
<td colspan="1" style="text-align: left;">
Total Rows: 7, Total Columns: 1
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-7" class="level2">
<h2 class="anchored" data-anchor-id="task-7">Task 7</h2>
<p>How many countries are in each region?</p>
<div id="66bb4d08" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">## How many countries are in each region?</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, aggregate, group by, order by)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="st">  Region,</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="st">  COUNT(*) AS "Country Count"</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="st">  world_bank_data.wdi_country</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="st">  `Income Group` IS NOT NULL</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="st">  Region</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="st">  Region</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="141">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Region
</th>

<th>
Country Count
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
East Asia &amp; Pacific
</td>

<td>
37
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

<td>
58
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

<td>
41
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
21
</td>

</tr>

<tr>

<td>
North America
</td>

<td>
3
</td>

</tr>

<tr>

<td>
South Asia
</td>

<td>
8
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

<td>
48
</td>

</tr>

<tr>
<td colspan="2" style="text-align: left;">
Total Rows: 7, Total Columns: 2
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-8" class="level2">
<h2 class="anchored" data-anchor-id="task-8">Task 8</h2>
<p>List the country full names and regions for all countries in north america.</p>
<div id="23759e98" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">## List the country full names and regions for all countries in north america</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, where, order by)</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="st">  `Long Name`,</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="st">  Region</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="st">  world_bank_data.wdi_country</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="st">  Region = 'North America'</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="st">  AND `Income Group` IS NOT NULL</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="st">  `Long Name`</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Long Name
</th>

<th>
Region
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
Canada
</td>

<td>
North America
</td>

</tr>

<tr>

<td>
The Bermudas
</td>

<td>
North America
</td>

</tr>

<tr>

<td>
United States of America
</td>

<td>
North America
</td>

</tr>

<tr>
<td colspan="2" style="text-align: left;">
Total Rows: 3, Total Columns: 2
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-9" class="level2">
<h2 class="anchored" data-anchor-id="task-9">Task 9</h2>
<div id="0df50e75" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">## The last World Cup soccer tournament was hosted by Qatar.</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">## What region contains Qatar?  List the region, country short name and full name</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, where)</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="st">  Region,</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="st">  `Short Name`,</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="st">  `Long Name`</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="st">  world_bank_data.wdi_country</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="st">  `Short Name` = 'Qatar'</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="st">  OR `Long Name` = 'Qatar'</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="143">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Region
</th>

<th>
Short Name
</th>

<th>
Long Name
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
Qatar
</td>

<td>
State of Qatar
</td>

</tr>

<tr>
<td colspan="3" style="text-align: left;">
Total Rows: 1, Total Columns: 3
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-10" class="level2">
<h2 class="anchored" data-anchor-id="task-10">Task 10</h2>
<div id="b97d0fe3" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">## There are two abbreviation fields in the data country_abbr and country_wb_abbr.</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">## List the country code, short name, abbr, wb_abbr and region for all the countries</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">## where the abbr and wb_abbr are different.</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, where, order by)</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="st">  `Country Code`,</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="st">  `Short Name`,</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="st">  `2-alpha code`,</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="st">  `WB-2 code`,</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="st">  Region</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="st">  world_bank_data.wdi_country</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="st">  `2-alpha code` != `WB-2 code`</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="st">  AND `Income Group` IS NOT NULL</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="st">  `Short Name`</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="144">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Country Code
</th>

<th>
Short Name
</th>

<th>
2-alpha code
</th>

<th>
WB-2 code
</th>

<th>
Region
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
COD
</td>

<td>
Dem. Rep.&nbsp;Congo
</td>

<td>
CD
</td>

<td>
ZR
</td>

<td>
Sub-Saharan Africa
</td>

</tr>

<tr>

<td>
SRB
</td>

<td>
Serbia
</td>

<td>
RS
</td>

<td>
YF
</td>

<td>
Europe &amp; Central Asia
</td>

</tr>

<tr>

<td>
TLS
</td>

<td>
Timor-Leste
</td>

<td>
TL
</td>

<td>
TP
</td>

<td>
East Asia &amp; Pacific
</td>

</tr>

<tr>

<td>
PSE
</td>

<td>
West Bank and Gaza
</td>

<td>
PS
</td>

<td>
GZ
</td>

<td>
Middle East &amp; North Africa
</td>

</tr>

<tr>

<td>
YEM
</td>

<td>
Yemen
</td>

<td>
YE
</td>

<td>
RY
</td>

<td>
Middle East &amp; North Africa
</td>

</tr>

<tr>
<td colspan="5" style="text-align: left;">
Total Rows: 5, Total Columns: 5
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-11" class="level2">
<h2 class="anchored" data-anchor-id="task-11">Task 11</h2>
<div id="cf1ab3d6" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Now, let's investigate the "income category" field.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">## List the income categories and the number of countries in each</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">## income category in descending order of most countries to least.</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, aggregate, group by, order by)</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="st">  `Income Group` AS "Income Category",</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="st">  COUNT(*) AS "Country Count"</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="st">  world_bank_data.wdi_country</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="st">  `Income Group`</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="st">  "Country Count" DESC;</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="145">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Income Category
</th>

<th>
Country Count
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
High income
</td>

<td>
85
</td>

</tr>

<tr>

<td>
NULL
</td>

<td>
49
</td>

</tr>

<tr>

<td>
Low income
</td>

<td>
26
</td>

</tr>

<tr>

<td>
Lower middle income
</td>

<td>
51
</td>

</tr>

<tr>

<td>
Upper middle income
</td>

<td>
54
</td>

</tr>

<tr>
<td colspan="2" style="text-align: left;">
Total Rows: 5, Total Columns: 2
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-12" class="level2">
<h2 class="anchored" data-anchor-id="task-12">Task 12</h2>
<div id="fd60d177" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">## This task depends on fixing Task 11. 1 country has NULL for income but has a region: Brunei Darussalam. All others are aggregates (non-countries).</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="st">  `Short Name`,</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="st">  `Region`,</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="st">  `Income Group`</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="st">  world_bank_data.wdi_country</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="st">  `Income Group` IS NULL</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="st">  AND Region IS NOT NULL;</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="146">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Short Name
</th>

<th>
Region
</th>

<th>
Income Group
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
Venezuela
</td>

<td>
Latin America &amp; Caribbean
</td>

<td>
NULL
</td>

</tr>

<tr>
<td colspan="3" style="text-align: left;">
Total Rows: 1, Total Columns: 3
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-13" class="level2">
<h2 class="anchored" data-anchor-id="task-13">Task 13</h2>
<div id="10f44eed" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">## OK, this HAS to be an error. Let's make a assumption that the country </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">## in question, because they are oil-rich, are "high income".  </span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Write an update comment to correct the issue.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">## </span><span class="al">NOTE</span><span class="co"> - if you get this wrong, all subsequent tables will be wrong!</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>execute_ddl(cnx,<span class="st">"""</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="st">UPDATE wdi_country</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="st">SET</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="st">  `Table Name` = 'Country',</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="st">  `Income Group` = 'High income'</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="st">  `Short Name` = 'Venezuela';</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="56068b3a" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Now, display the country again to verify the change stuck!</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="st">  `Short Name`,</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="st">  `Table Name`,</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="st">  `Income Group`</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="st">  wdi_country</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="st">  `Short Name` = 'Venezuela';</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="148">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Short Name
</th>

<th>
Table Name
</th>

<th>
Income Group
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
Venezuela
</td>

<td>
Venezuela, RB
</td>

<td>
NULL
</td>

</tr>

<tr>
<td colspan="3" style="text-align: left;">
Total Rows: 1, Total Columns: 3
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-14" class="level2">
<h2 class="anchored" data-anchor-id="task-14">Task 14</h2>
<div id="f684784a" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Write a single query that show the number of countries in each </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">## "Region"-"Income Group" pair.  The table should have 3 columns:</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">## region, income group, and no.of.countries.</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, aggregate, group by, order by)</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="st">  Region,</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="st">  `Income Group`,</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="st">  COUNT(*) AS "no.of.countries"</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="st">  world_bank_data.wdi_country</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="st">  `Income Group` IS NOT NULL</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="st">  Region,</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="st">  `Income Group`</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="st">  Region,</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="st">  `Income Group`</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="149">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Region
</th>

<th>
Income Group
</th>

<th>
no.of.countries
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
East Asia &amp; Pacific
</td>

<td>
High income
</td>

<td>
15
</td>

</tr>

<tr>

<td>
East Asia &amp; Pacific
</td>

<td>
Low income
</td>

<td>
1
</td>

</tr>

<tr>

<td>
East Asia &amp; Pacific
</td>

<td>
Lower middle income
</td>

<td>
12
</td>

</tr>

<tr>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

<td>
9
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

<td>
High income
</td>

<td>
40
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

<td>
Lower middle income
</td>

<td>
3
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

<td>
Upper middle income
</td>

<td>
15
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

<td>
High income
</td>

<td>
18
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

<td>
Lower middle income
</td>

<td>
4
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

<td>
Upper middle income
</td>

<td>
19
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
High income
</td>

<td>
8
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
Low income
</td>

<td>
2
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
Lower middle income
</td>

<td>
7
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
Upper middle income
</td>

<td>
4
</td>

</tr>

<tr>

<td>
North America
</td>

<td>
High income
</td>

<td>
3
</td>

</tr>

<tr>

<td>
South Asia
</td>

<td>
Low income
</td>

<td>
1
</td>

</tr>

<tr>

<td>
South Asia
</td>

<td>
Lower middle income
</td>

<td>
6
</td>

</tr>

<tr>

<td>
South Asia
</td>

<td>
Upper middle income
</td>

<td>
1
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

<td>
High income
</td>

<td>
1
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

<td>
Low income
</td>

<td>
22
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

<td>
Lower middle income
</td>

<td>
19
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

<td>
Upper middle income
</td>

<td>
6
</td>

</tr>

<tr>
<td colspan="3" style="text-align: left;">
Total Rows: 22, Total Columns: 3
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-15" class="level2">
<h2 class="anchored" data-anchor-id="task-15">Task 15</h2>
<div id="df60a559" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Examine the result from task 14. It would be really cool to</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">## present the results of this table in a 2-D form, with </span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">## columns for each income category (high, upper middle, lower middle, low, other)</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">## regions down the side, and the pair-wise count inside each cell.</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Using CASE statements, DO IT!  BE SURE to include the countries without</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">## an income category.</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">## HINT - your query should return 6 columns: the region name, one</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">## column for each of the income categories (e.g., High, Upper middle, etc.)</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">## and a column for the row totals.</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, aggregate, group by, nested query)</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="st">  Region,</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="st">  SUM(CASE WHEN `Income Group` = 'High income' THEN 1 ELSE 0 END) AS "High",</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="st">  SUM(CASE WHEN `Income Group` = 'Upper middle income' THEN 1 ELSE 0 END) AS "Upper middle",</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="st">  SUM(CASE WHEN `Income Group` = 'Lower middle income' THEN 1 ELSE 0 END) AS "Lower middle",</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="st">  SUM(CASE WHEN `Income Group` = 'Low income' THEN 1 ELSE 0 END) AS "Low",</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="st">  SUM(CASE WHEN `Income Group` IS NULL THEN 1 ELSE 0 END) AS "Other",</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="st">  COUNT(*) AS "Total"</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="st">  wdi_country</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="st">  `Table Name` = 'Country'</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="st">  Region</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="st">  Region;</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="150">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Region
</th>

<th>
High
</th>

<th>
Upper middle
</th>

<th>
Lower middle
</th>

<th>
Low
</th>

<th>
Other
</th>

<th>
Total
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
no records returned
</td>

<td>
</td>

<td>
</td>

<td>
</td>

<td>
</td>

<td>
</td>

<td>
</td>

</tr>

<tr>
<td colspan="7" style="text-align: left;">
Total Rows: 1, Total Columns: 7
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-16" class="level2">
<h2 class="anchored" data-anchor-id="task-16">Task 16</h2>
<div id="a42239aa" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Wow! what a cool table!  It is very interesting to see where the money</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">## sits around the world.  Using the general approach from Task 14 above</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">## and write a query to return the single region with the most lower-income</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">## countries.</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">## Your query should return 3 columns, the number of </span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">## low-income countries, the region name and the income group</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">## PUT THE NUMBER FIRST! (use: count, region name, income group)</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, aggregate, group by, nested query, order by, limit)</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="st">  COUNT(*) AS "Low Income Count",</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="st">  Region,</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="st">  `Income Group`</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="st">  wdi_country</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="st">  `Income Group` = 'Low income'</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="st">  AND `Table Name` = 'Country'</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY Region, `Income Group`</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY "Low Income Count" DESC</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 1;</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="151">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Low Income Count
</th>

<th>
Region
</th>

<th>
Income Group
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
no records returned
</td>

<td>
</td>

<td>
</td>

</tr>

<tr>
<td colspan="3" style="text-align: left;">
Total Rows: 1, Total Columns: 3
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-17" class="level2">
<h2 class="anchored" data-anchor-id="task-17">Task 17</h2>
<div id="bdd953be" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Are you getting the hand of this? Good! We need to take a look at all</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">## the countries in the same region and with the same income category as</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">## the Marshall Islands.</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">## For each country that matches, print their country code, short name,</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">## region and income category, by order of their short name.  As a hint,</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">## the country code for the Marshall Islands is MHL.</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, where, subquery)</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="st">  `Country Code`,</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="st">  `Short Name`,</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="st">  Region,</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="st">  `Income Group`</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="st">  world_bank_data.wdi_country</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="st">  Region = (</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT Region</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM world_bank_data.wdi_country</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="st">    WHERE `Country Code` = 'MHL'</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="st">  )</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="st">  AND `Income Group` = (</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT `Income Group`</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM world_bank_data.wdi_country</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="st">    WHERE `Country Code` = 'MHL'</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="st">  )</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="st">  AND `Income Group` IS NOT NULL</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="st">  `Short Name`</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="152">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Country Code
</th>

<th>
Short Name
</th>

<th>
Region
</th>

<th>
Income Group
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
CHN
</td>

<td>
China
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
FJI
</td>

<td>
Fiji
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
IDN
</td>

<td>
Indonesia
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
MYS
</td>

<td>
Malaysia
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
MHL
</td>

<td>
Marshall Islands
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
MNG
</td>

<td>
Mongolia
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
THA
</td>

<td>
Thailand
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
TON
</td>

<td>
Tonga
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
TUV
</td>

<td>
Tuvalu
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>
<td colspan="4" style="text-align: left;">
Total Rows: 9, Total Columns: 4
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-18" class="level2">
<h2 class="anchored" data-anchor-id="task-18">Task 18</h2>
<div id="0a174efe" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">## OK - let's raise the heat in the kitchen! Review the output from task 14.</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">## You'll see that some of the regions do not contain all of the income</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">## levels.  For example, the Europe &amp; Central Asia region does not have</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">## any low income countries.</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">## CHALLENGE - using a SINGLE SQL statement, write a table that contains every</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">## combination of region and income category (including the missing '') values!</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">## THEN add a WHERE clause to only show the values that were missing from</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co">## the original pairings!</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co">## HINT - there should be AT MOST [# of regions]x[# of income cats] = 28</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">## rows in your final table, and there are 22 rows returned in the query</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co">## in Task 14.  (FYI - I get 6 rows in my final table.)</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, where, subqueries, joins)</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="st">WITH AllPairs AS (</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="st">    r.Region,</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="st">    i.`Income Group`</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="st">    (SELECT DISTINCT Region FROM world_bank_data.wdi_country WHERE Region IS NOT NULL) r</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="st">    CROSS JOIN</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="st">    (SELECT DISTINCT `Income Group` FROM world_bank_data.wdi_country WHERE `Income Group` IS NOT NULL) i</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="st">),</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="st">ExistingPairs AS (</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT DISTINCT</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="st">    Region,</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="st">    `Income Group`</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="st">    world_bank_data.wdi_country</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a><span class="st">    `Income Group` IS NOT NULL</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="st">  ap.Region,</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a><span class="st">  ap.`Income Group`,</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a><span class="st">  'Missing' AS Status</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a><span class="st">FROM AllPairs ap</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a><span class="st">LEFT JOIN ExistingPairs ep</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a><span class="st">  ON ap.Region = ep.Region AND ap.`Income Group` = ep.`Income Group`</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE ep.Region IS NULL</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY ap.Region, ap.`Income Group`;</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="153">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Region
</th>

<th>
Income Group
</th>

<th>
Status
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
Europe &amp; Central Asia
</td>

<td>
Low income
</td>

<td>
Missing
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

<td>
Low income
</td>

<td>
Missing
</td>

</tr>

<tr>

<td>
North America
</td>

<td>
Low income
</td>

<td>
Missing
</td>

</tr>

<tr>

<td>
North America
</td>

<td>
Lower middle income
</td>

<td>
Missing
</td>

</tr>

<tr>

<td>
North America
</td>

<td>
Upper middle income
</td>

<td>
Missing
</td>

</tr>

<tr>

<td>
South Asia
</td>

<td>
High income
</td>

<td>
Missing
</td>

</tr>

<tr>
<td colspan="3" style="text-align: left;">
Total Rows: 6, Total Columns: 3
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-19" class="level2">
<h2 class="anchored" data-anchor-id="task-19">Task 19</h2>
<div id="7ef2657f" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Hot enough, yet?  Let's go for ghost-pepper HOT!  Now let's build some</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">## percentage tables.  For example, across the entire sample, what</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">## is the percentage of total countries in each income category?</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">## As a first step, build off the result from task 14 and create a table with</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">## six columns (region, income cat, country count, sum of countries in region,</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">## sum of countries by income and total sum countries).</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co">## THEN, add a 7th column calculating the percent of total for each,</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">## region-income pair.</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co">## actually calculating percentages and print out a table will be a</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co">## slam dunk after this!</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, where, subqueries, joins, aggregate functions)</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="st">WITH Counts AS (</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="st">    Region,</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="st">    `Income Group`,</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="st">    COUNT(*) AS country_count</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="st">    wdi_country</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="st">    `Income Group` IS NOT NULL</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="st">    AND `Table Name` = 'Country'</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY Region, `Income Group`</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="st">),</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="st">Totals AS (</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="st">    Region,</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="st">    SUM(country_count) AS region_total</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a><span class="st">    Counts</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="st">    Region</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a><span class="st">),</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="st">IncomeTotals AS (</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a><span class="st">    `Income Group`,</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a><span class="st">    SUM(country_count) AS income_total</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="st">    Counts</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a><span class="st">    `Income Group`</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a><span class="st">),</span></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a><span class="st">GrandTotal AS (</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a><span class="st">    SUM(country_count) AS total_countries</span></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM</span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a><span class="st">    Counts</span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a><span class="st">  c.Region,</span></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a><span class="st">  c.`Income Group`,</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a><span class="st">  c.country_count,</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a><span class="st">  t.region_total,</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a><span class="st">  i.income_total,</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a><span class="st">  g.total_countries,</span></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a><span class="st">  ROUND((c.country_count / g.total_countries) * 100, 2) AS percent_of_total</span></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a><span class="st">  Counts c</span></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN</span></span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a><span class="st">  Totals t ON c.Region = t.Region</span></span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN</span></span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a><span class="st">  IncomeTotals i ON c.`Income Group` = i.`Income Group`</span></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a><span class="st">CROSS JOIN</span></span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a><span class="st">  GrandTotal g</span></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY</span></span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a><span class="st">  c.Region,</span></span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a><span class="st">  c.`Income Group`</span></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="154">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Region
</th>

<th>
Income Group
</th>

<th>
country_count
</th>

<th>
region_total
</th>

<th>
income_total
</th>

<th>
total_countries
</th>

<th>
percent_of_total
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
no records returned
</td>

<td>
</td>

<td>
</td>

<td>
</td>

<td>
</td>

<td>
</td>

<td>
</td>

</tr>

<tr>
<td colspan="7" style="text-align: left;">
Total Rows: 1, Total Columns: 7
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-20" class="level2">
<h2 class="anchored" data-anchor-id="task-20">Task 20</h2>
<div id="bd207fe9" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">## SLAM DUNK TIME!  Using the resulting table CTEs from Task 19,</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">## print table similar to the table in Task 15, with Income group in the</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">## columns, Region in the rows and Percent of total in each cell of the table.</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="st">WITH Counts AS (</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="st">    Region,</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="st">    `Income Group`,</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="st">    COUNT(*) AS country_count</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="st">    world_bank_data.wdi_country</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="st">    `Income Group` IS NOT NULL</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="st">    Region,</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="st">    `Income Group`</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="st">),</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="st">GrandTotal AS (</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="st">    SUM(country_count) AS total_countries</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="st">    Counts</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="st">  c.Region,</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="st">  ROUND(SUM(CASE WHEN c.`Income Group` = 'High income' THEN (c.country_count / g.total_countries) * 100 ELSE 0 END), 2) AS "High",</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="st">  ROUND(SUM(CASE WHEN c.`Income Group` = 'Upper middle income' THEN (c.country_count / g.total_countries) * 100 ELSE 0 END), 2) AS "Upper middle",</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="st">  ROUND(SUM(CASE WHEN c.`Income Group` = 'Lower middle income' THEN (c.country_count / g.total_countries) * 100 ELSE 0 END), 2) AS "Lower middle",</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="st">  ROUND(SUM(CASE WHEN c.`Income Group` = 'Low income' THEN (c.country_count / g.total_countries) * 100 ELSE 0 END), 2) AS "Low",</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="st">  ROUND(SUM(c.country_count / g.total_countries) * 100, 2) AS "Total"</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="st">  Counts c</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a><span class="st">CROSS JOIN</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="st">  GrandTotal g</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a><span class="st">  c.Region</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a><span class="st">  c.Region</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="155">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Region
</th>

<th>
High
</th>

<th>
Upper middle
</th>

<th>
Lower middle
</th>

<th>
Low
</th>

<th>
Total
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
East Asia &amp; Pacific
</td>

<td>
6.94
</td>

<td>
4.17
</td>

<td>
5.56
</td>

<td>
0.46
</td>

<td>
17.13
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

<td>
18.52
</td>

<td>
6.94
</td>

<td>
1.39
</td>

<td>
0.00
</td>

<td>
26.85
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

<td>
8.33
</td>

<td>
8.80
</td>

<td>
1.85
</td>

<td>
0.00
</td>

<td>
18.98
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
3.70
</td>

<td>
1.85
</td>

<td>
3.24
</td>

<td>
0.93
</td>

<td>
9.72
</td>

</tr>

<tr>

<td>
North America
</td>

<td>
1.39
</td>

<td>
0.00
</td>

<td>
0.00
</td>

<td>
0.00
</td>

<td>
1.39
</td>

</tr>

<tr>

<td>
South Asia
</td>

<td>
0.00
</td>

<td>
0.46
</td>

<td>
2.78
</td>

<td>
0.46
</td>

<td>
3.70
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

<td>
0.46
</td>

<td>
2.78
</td>

<td>
8.80
</td>

<td>
10.19
</td>

<td>
22.23
</td>

</tr>

<tr>
<td colspan="6" style="text-align: left;">
Total Rows: 7, Total Columns: 6
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-21" class="level2">
<h2 class="anchored" data-anchor-id="task-21">Task 21</h2>
<div id="850ba3c3" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">## ANOTHER DUNK!  Using the resulting table CTEs from Task 19,</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">## print a table listing the number, totals and percentage of countries</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">## by income category.</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">## (This is much simpler than task 20!)</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="st">WITH Counts AS (</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="st">    `Income Group`,</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="st">    COUNT(*) AS country_count</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="st">    wdi_country</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="st">    `Income Group` IS NOT NULL</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="st">    AND `Table Name` = 'Country'</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY `Income Group`</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="st">),</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="st">GrandTotal AS (</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT SUM(country_count) AS total_countries FROM Counts</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="st">  c.`Income Group`,</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="st">  c.country_count,</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="st">  g.total_countries,</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="st">  ROUND((c.country_count * 100.0 / g.total_countries), 2) AS "Percent of Total"</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="st">FROM Counts c</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="st">CROSS JOIN GrandTotal g</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY c.country_count DESC;</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="156">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Income Group
</th>

<th>
country_count
</th>

<th>
total_countries
</th>

<th>
Percent of Total
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
no records returned
</td>

<td>
</td>

<td>
</td>

<td>
</td>

</tr>

<tr>
<td colspan="4" style="text-align: left;">
Total Rows: 1, Total Columns: 4
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
</section>
<section id="reflection" class="level1">
<h1>Reflection</h1>
<ol type="1">
<li>Reflect on the SQL skills you used throughout these exercises. Which skills do you feel most confident in, and which do you think need more practice? How has this assignment helped you build or reinforce specific SQL competencies?</li>
</ol>
<p>( response goes here)</p>
<ol start="2" type="1">
<li>Problem-Solving Approach: Describe your approach to tackling the more complex tasks (like Tasks 18, 23, and 24). How did you break down these problems, and what steps did you take when you encountered challenges? How would you approach a similar problem differently in the future?</li>
</ol>
<p>Whenever I ran into trouble, the most helpful debugging tool for me was using SQLTools and connecting to the remote DM to be able to manually run SQL commands to quickly understand what each command or query would do before plugging it back in. When worse came to worse, and breaking things down using the SQLTools platform wasn’t helping me progress, I asked chat to help debug the more complex problems.</p>
<ol start="3" type="1">
<li>Learning Takeaways: Consider the overall learning experience from this assignment. What were the biggest takeaways about working with SQL for data analysis and transformation? How do you think these skills will apply in real-world scenarios or future coursework?</li>
</ol>
<p>( response goes here)</p>
</section>
<section id="readme" class="level1">
<h1>README</h1>
</section>
<section id="cmsc408-sp2025-hw8" class="level1" style="background:lightgray; margin-left:20px; border-top: 3px solid black; border-bottom: 3px solid black; padding-left:20px; padding-right:20px">
<h1>cmsc408-sp2025-hw8</h1>
<p>Homework 8 - World Bank Indicator Analysis</p>
<p>Hello! Welcome to HW 8!</p>
<p>In this assignment, I will be working through 21 SQL queries! This will help improve my SQL skills and generate a Report.HTML file which will walk through each query with code and outputs included for each!</p>
<p>We will be working with a remote database! Our queries will take place in the Report.QMD file in the Reports folder! This will be the only file we will be editing for this assignment!</p>
<p>I also updated .env with the HW8 passcode! This HW will be in preperation for our final Database assignment! My group (Group 408) will be making a database for a country club!</p>
<p>Thank you! I hope this HW assignment is as exciting to read as it was to create!</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>